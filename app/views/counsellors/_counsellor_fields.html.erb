<div class="counsellor-form-group" style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 16px; background-color: #f9fafb;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
    <h3 style="font-size: 18px; font-weight: 600; color: #1f2937;">Counselor <%= index + 1 %>'s Information:</h3>
    <% if index > 0 %>
      <button type="button" class="remove-counsellor-btn" style="color: #dc2626; font-size: 14px; background: none; border: none; cursor: pointer; padding: 4px 8px;">Remove</button>
    <% end %>
  </div>

  <div class="form-group" style="margin-bottom: 12px;">
    <label class="form-label">Name</label>
    <div class="form-grid form-grid-2">
      <input type="text" name="counsellors[<%= index %>][first_name]" class="form-control" placeholder="First" required value="<%= counsellor.first_name %>">
      <input type="text" name="counsellors[<%= index %>][last_name]" class="form-control" placeholder="Last" required value="<%= counsellor.last_name %>">
    </div>
  </div>

  <div class="form-group" style="margin-bottom: 12px;">
    <label class="form-label">Gender</label>
    <select name="counsellors[<%= index %>][gender]" class="form-control" required>
      <option value="">Choose...</option>
      <option value="Male" <%= 'selected' if counsellor.gender == 'Male' %>>Male</option>
      <option value="Female" <%= 'selected' if counsellor.gender == 'Female' %>>Female</option>
    </select>
  </div>

  <div class="form-group" style="margin-bottom: 12px;">
    <label class="form-label">Address</label>
    <% if index > 0 %>
      <div style="margin-bottom: 8px;">
        <label style="display: flex; align-items: center; cursor: pointer;">
          <input type="checkbox" class="same-address-checkbox" data-counsellor-index="<%= index %>" style="margin-right: 8px; cursor: pointer;">
          <span style="font-size: 14px; color: #6b7280;">Same address as previous counselor</span>
        </label>
      </div>
    <% end %>
    <input type="text" name="counsellors[<%= index %>][address_line_1]" class="form-control address-field" placeholder="Address Line 1" required style="margin-bottom: 12px;" value="<%= counsellor.address_line_1 %>" data-field="address_line_1">
    <div class="form-grid form-grid-4">
      <div class="form-group">
        <input type="text" name="counsellors[<%= index %>][city]" class="form-control address-field" placeholder="City" required value="<%= counsellor.city %>" data-field="city">
      </div>
      <div class="form-group">
        <input type="text" name="counsellors[<%= index %>][state_province_region]" class="form-control address-field" placeholder="State / Province / Region" required value="<%= counsellor.state_province_region %>" data-field="state_province_region">
      </div>
      <div class="form-group">
        <input type="text" name="counsellors[<%= index %>][postal_code]" class="form-control address-field" placeholder="Postal Code" required pattern="[\d\w\s\-]+" title="Please enter a valid postal code" value="<%= counsellor.postal_code %>" data-field="postal_code">
      </div>
      <div class="form-group">
        <select name="counsellors[<%= index %>][country]" class="form-control address-field" required data-field="country">
          <% countries = [
            ['United States of America', 'United States of America'],
            ['Canada', 'Canada'],
            ['Mexico', 'Mexico'],
            ['United Kingdom', 'United Kingdom'],
            ['Australia', 'Australia'],
            ['New Zealand', 'New Zealand'],
            ['Other', 'Other']
          ] %>
          <% countries.each do |country_name, country_value| %>
            <option value="<%= country_value %>" <%= 'selected' if (counsellor.country || 'United States of America') == country_value %>><%= country_name %></option>
          <% end %>
        </select>
      </div>
    </div>
  </div>

  <div class="form-grid form-grid-2" style="margin-bottom: 12px;">
    <div class="form-group">
      <label class="form-label">Home/Cell Phone</label>
      <input type="tel" name="counsellors[<%= index %>][phone]" class="form-control" required pattern="[\d\s\-\(\)\+\.]+" title="Please enter a valid phone number" value="<%= counsellor.phone %>">
    </div>

    <div class="form-group">
      <label class="form-label">Email</label>
      <input type="email" name="counsellors[<%= index %>][email]" class="form-control" required value="<%= counsellor.email %>">
    </div>
  </div>

  <div class="form-grid form-grid-2" style="margin-bottom: 12px;">
    <div class="form-group">
      <label class="form-label">Ecclesia</label>
      <input type="text" name="counsellors[<%= index %>][ecclesia]" class="form-control" required value="<%= counsellor.ecclesia %>">
    </div>

    <div class="form-group">
      <label class="form-label">T-Shirt Size</label>
      <select name="counsellors[<%= index %>][tshirt_size]" class="form-control" required>
        <option value="">Choose...</option>
        <% sizes = ['Youth S', 'Youth M', 'Youth L', 'Youth XL', 'Adult S', 'Adult M', 'Adult L', 'Adult XL', 'Adult XXL'] %>
        <% sizes.each do |size| %>
          <option value="<%= size %>" <%= 'selected' if counsellor.tshirt_size == size %>><%= size %></option>
        <% end %>
      </select>
    </div>
  </div>

  <div class="form-group" style="margin-bottom: 12px;">
    <label class="form-label">Plays the piano and would be willing to play a couple hymns</label>
    <select name="counsellors[<%= index %>][piano]" class="form-control" required>
      <option value="">Choose...</option>
      <option value="Yes" <%= 'selected' if counsellor.piano == 'Yes' %>>Yes</option>
      <option value="No" <%= 'selected' if counsellor.piano == 'No' %>>No</option>
    </select>
  </div>

  <!-- Pairing Request Section -->
  <div class="form-group" style="margin-bottom: 12px; border-top: 1px solid #e5e7eb; padding-top: 16px;">
    <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">Pairing Request (Optional)</h4>
    <p style="font-size: 13px; color: #6b7280; margin-bottom: 12px;">Counselors are typically grouped in pairs. You can request to be paired with other counselors being registered in this form, or request pairing with someone who will register separately.</p>
    
    <div class="form-group" style="margin-bottom: 12px;">
      <label class="form-label">Request pairing with other counselors in this form:</label>
      <select name="counsellors[<%= index %>][requested_pairing_with][]" class="pairing-select form-control" multiple style="min-height: 100px;">
        <!-- Options will be populated dynamically by JavaScript -->
      </select>
    </div>
    
    <div class="form-group" style="margin-bottom: 12px;">
      <label class="form-label">Request pairing with someone not in this form:</label>
      <input type="text" name="counsellors[<%= index %>][requested_pairing_name]" class="form-control" placeholder="Enter name of person you'd like to be paired with" value="<%= counsellor.requested_pairing_name %>">
      <p style="font-size: 12px; color: #6b7280; margin-top: 4px;">If you know someone who will register separately, enter their name here.</p>
    </div>
  </div>

  <!-- Squirts Section -->
  <div class="squirts-section" style="border-top: 1px solid #e5e7eb; padding-top: 16px; margin-top: 16px;">
    <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Squirts (Children)</h4>
    <p style="font-size: 13px; color: #6b7280; margin-bottom: 12px;">Squirts are children aged 3-8 who can participate in squirts activities and classes. You can register all your children here, and we'll note that those aged 3-8 can participate in squirts activities.</p>
    
    <div class="squirts-container">
      <!-- Squirts will be added here dynamically -->
    </div>
    
    <button type="button" class="add-squirt-btn btn btn-outline" style="margin-top: 8px; font-size: 14px; padding: 6px 12px;">
      + Add Child
    </button>
    
    <!-- Template for squirt form (hidden) -->
    <template class="squirt-template">
      <div class="squirt-form-group" style="border: 1px solid #d1d5db; border-radius: 6px; padding: 12px; margin-bottom: 8px; background-color: white;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
          <h5 style="font-size: 14px; font-weight: 600;">Child</h5>
          <button type="button" class="remove-squirt-btn" style="color: #dc2626; font-size: 12px; background: none; border: none; cursor: pointer;">Remove</button>
        </div>
        <div class="form-grid form-grid-3">
          <div class="form-group">
            <label class="form-label" style="font-size: 13px;">Name</label>
            <input type="text" name="counsellors[<%= index %>][squirts][{TIMESTAMP}][name]" class="form-control" placeholder="Child's name">
          </div>
          <div class="form-group">
            <label class="form-label" style="font-size: 13px;">Gender</label>
            <select name="counsellors[<%= index %>][squirts][{TIMESTAMP}][gender]" class="form-control">
              <option value="">Choose...</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label" style="font-size: 13px;">Age</label>
            <input type="number" name="counsellors[<%= index %>][squirts][{TIMESTAMP}][age]" class="form-control" placeholder="Age" min="0" max="18">
          </div>
        </div>
      </div>
    </template>
  </div>
</div>
